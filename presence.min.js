var Presence=function(){function a(a){var c=new Image;c.src=a.getImageDataUrl(),b.showSnapshots&&b.dropElement&&(b.dropElement.innerHTML="",b.dropElement.appendChild(c)),b.mismatch=a.misMatchPercentage,a.misMatchPercentage>b.mismatchThreshold?(b.present||b.onEnter(b),b.present=!0,b.isPresent(b)):(b.present&&b.onLeave(b),b.present=!1,b.isNotPresent(b))}var b=this;b.rate=400,b.mismatchThreshold=.01,b.canvas=null,b.context=null,b.video=null,b.showSnapshots=!1,b.dropElement=null;var c=null,d={video:!0},e=window.URL||window.webkitURL;b.errBack=function(a){console.log("Video capture error: ",a.code)},b.resembleControl=null,b.frames=[],b.present=!1,b.onEnter=function(){console.log("You Entered!")},b.onLeave=function(){console.log("You Left!")},b.isPresent=function(){console.log("You are there!")},b.isNotPresent=function(){console.log("You are not there!")},b.stop=function(){b.interval&&window.clearInterval(b.interval),c.stop()},b.start=function(){resemble||console.error("Resamble lib not found"),b.canvas&&b.video||console.error("Configure canvas and video elements"),b.context=b.canvas.getContext("2d"),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia&&navigator.getUserMedia(d,function(a){c=a,b.video.src=e?e.createObjectURL(a):a,b.video.play()},b.errBack),b.interval=window.setInterval(function(){b.context.drawImage(video,0,0,640,480),b.compare(b.canvas.toDataURL("image/png"))},b.rate)},b.compare=function(c){b.frames.push(c),b.frames.length>2&&b.frames.shift(),resemble(c).onComplete(function(a){b.red=a.red,b.green=a.green,b.blue=a.blue,b.brightness=a.brightness}),2==b.frames.length&&(b.resembleControl=resemble(b.frames[0]).compareTo(b.frames[1]).onComplete(a))}};