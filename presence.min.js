!function(a,b){"function"==typeof define&&define.amd?define(["Presence"],function(c){return a.Presence=b(c)}):"object"==typeof exports?module.exports=b(require("presence_js")):a.Presence=b(a.Presence)}(this,function(a){function b(a){var b=new Image;b.src=a.getImageDataUrl(),c.showSnapshots&&c.dropElement&&(c.dropElement.innerHTML="",c.dropElement.appendChild(b)),c.mismatch=a.misMatchPercentage,a.misMatchPercentage>c.mismatchThreshold?(c.present||c.onEnter(c),c.present=!0,c.isPresent(c)):(c.present&&c.onLeave(c),c.present=!1,c.isNotPresent(c))}var c=this||global;c.rate=400,c.mismatchThreshold=.01,c.canvas=null,c.context=null,c.video=null,c.showSnapshots=!1,c.dropElement=null;var d=null,e={video:!0},f=window.URL||window.webkitURL;return c.errBack=function(a){console.log("Video capture error: ",a.code)},c.resembleControl=null,c.frames=[],c.present=!1,c.onEnter=function(){console.log("You Entered!")},c.onLeave=function(){console.log("You Left!")},c.isPresent=function(){console.log("You are there!")},c.isNotPresent=function(){console.log("You are not there!")},c.stop=function(){c.interval&&window.clearInterval(c.interval),d.stop()},c.start=function(){resemble||console.error("Resamble lib not found"),c.canvas&&c.video||console.error("Configure canvas and video elements"),c.context=c.canvas.getContext("2d"),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia&&navigator.getUserMedia(e,function(a){d=a,c.video.src=f?f.createObjectURL(a):a,c.video.play()},c.errBack),c.interval=window.setInterval(function(){c.context.drawImage(video,0,0,640,480),c.compare(c.canvas.toDataURL("image/png"))},c.rate)},c.compare=function(a){c.frames.push(a),c.frames.length>2&&c.frames.shift(),resemble(a).onComplete(function(a){c.red=a.red,c.green=a.green,c.blue=a.blue,c.brightness=a.brightness}),2==c.frames.length&&(c.resembleControl=resemble(c.frames[0]).compareTo(c.frames[1]).onComplete(b))},c});