!function(a,b){"function"==typeof define&&define.amd?define(["Presence"],function(c){return a.Presence=b(c)}):"object"==typeof exports?module.exports=b(require("presence_js")):a.Presence=b(a.Presence)}(this,function(a){function b(a){j.frames.push(a),j.frames.length>2&&j.frames.shift(),resemble(a).onComplete(function(a){j.red=a.red,j.green=a.green,j.blue=a.blue,j.brightness=a.brightness}),2==j.frames.length&&(j.resembleControl=resemble(j.frames[0]).compareTo(j.frames[1]).onComplete(c))}function c(a){var b=new Image;b.src=a.getImageDataUrl(),j.showSnapshots&&j.dropElement&&(j.dropElement.innerHTML="",j.dropElement.appendChild(b)),j.mismatch=a.misMatchPercentage,d(a.misMatchPercentage>j.mismatchThreshold?!0:!1)}function d(a){a?(j.isPresent(j),j.present||j.onEnter(j)):(j.isNotPresent(j),j.present&&j.onLeave(j)),j.present=a}function e(a){var b=a||document.body;b.addEventListener("keypress",g,!1),b.addEventListener("mousemove",g,!1),b.addEventListener("mousedown",g,!1),b.addEventListener("DOMMouseScroll",g,!1),b.addEventListener("mousewheel",g,!1),b.addEventListener("touchmove",g,!1),b.addEventListener("MSPointerMove",g,!1),f()}function f(){n=window.setTimeout(i,4e3)}function g(a){window.clearTimeout(n),h()}function h(){d(!0),f()}function i(){d(!1)}var j=this||global;j.rate=400,j.mismatchThreshold=.01,j.canvas=null,j.context=null,j.video=null,j.showSnapshots=!1,j.dropElement=null;var k=null,l={video:!0},m=window.URL||window.webkitURL;j.errBack=function(a){console.log("Video capture error: ",a.code)},j.resembleControl=null,j.frames=[],j.present=!1,j.onEnter=function(){console.log("You Entered!")},j.onLeave=function(){console.log("You Left!")},j.isPresent=function(){console.log("You are there!")},j.isNotPresent=function(){console.log("You are not there!")},j.stop=function(){j.interval&&window.clearInterval(j.interval),k.stop()},j.start=function(){resemble||console.error("Resemble lib not found"),j.canvas&&j.video||console.error("Configure canvas and video elements"),j.context=j.canvas.getContext("2d"),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia&&navigator.getUserMedia(l,function(a){k=a,j.video.src=m?m.createObjectURL(a):a,j.video.play()},j.errBack),j.interval=window.setInterval(function(){j.context.drawImage(j.video,0,0,320,240),b(j.canvas.toDataURL("image/png"))},j.rate),e(document.body)};var n;return j});