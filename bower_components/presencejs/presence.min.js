!function(a,b){"function"==typeof define&&define.amd?define(["Presence"],function(c){return a.Presence=b(c)}):"object"==typeof exports?module.exports=b(require("presence_js")):a.Presence=b(a.Presence)}(this,function(a){function b(a){e.frames.push(a),e.frames.length>2&&e.frames.shift(),resemble(a).onComplete(function(a){e.red=a.red,e.green=a.green,e.blue=a.blue,e.brightness=a.brightness}),2==e.frames.length&&(e.resembleControl=resemble(e.frames[0]).compareTo(e.frames[1]).onComplete(c))}function c(a){var b=new Image;b.src=a.getImageDataUrl(),e.showSnapshots&&e.dropElement&&(e.dropElement.innerHTML="",e.dropElement.appendChild(b)),e.mismatch=a.misMatchPercentage,d(a.misMatchPercentage>e.mismatchThreshold?!0:!1)}function d(a){a?(e.isPresent(e),e.present||e.onEnter(e)):(e.isNotPresent(e),e.present&&e.onLeave(e)),e.present=a}var e=this||global;e.rate=400,e.mismatchThreshold=.01,e.canvas=null,e.context=null,e.video=null,e.showSnapshots=!1,e.dropElement=null;var f=null,g={video:!0},h=window.URL||window.webkitURL;return e.errBack=function(a){console.log("Video capture error: ",a.code)},e.resembleControl=null,e.frames=[],e.present=!1,e.onEnter=function(){console.log("You Entered!")},e.onLeave=function(){console.log("You Left!")},e.isPresent=function(){console.log("You are there!")},e.isNotPresent=function(){console.log("You are not there!")},e.stop=function(){e.interval&&window.clearInterval(e.interval),f.stop()},e.start=function(){resemble||console.error("Resemble lib not found"),e.canvas&&e.video||console.error("Configure canvas and video elements"),e.context=e.canvas.getContext("2d"),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia&&navigator.getUserMedia(g,function(a){f=a,e.video.src=h?h.createObjectURL(a):a,e.video.play()},e.errBack),e.interval=window.setInterval(function(){e.context.drawImage(e.video,0,0,320,240),b(e.canvas.toDataURL("image/png"))},e.rate)},e});